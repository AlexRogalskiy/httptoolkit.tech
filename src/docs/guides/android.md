---
name: 'Android'
title: 'Intercepting Android HTTP'
order: 1
---

**Android support is in invite-only alpha. Want to try it out? [Get in touch](/contact)**

HTTP Toolkit can automatically intercept, inspect & rewrite traffic from any Android device.

For plain HTTP, or for HTTP & HTTPS traffic from most browsers this works with zero manual setup required.

To intercept secure HTTPS traffic from other modern apps, you need to either:

- Make a small change to the app's config, so that it trusts user-installed CA certificates
- Use an emulator or a rooted device with HTTP Toolkit's ADB-based interception, to inject a system CA certificate.

If you're debugging your own app, rebuilding with the config change and using any test device you like is very quick and easy, and usually the simplest option. If you're trying to intercept HTTPS from a 3rd party app or an existing build that can't be easily changed, you'll usually want to use an emulator or rooted device instead.

Keep reading to get started right away, or jump to the full details for your case in ['intercepting HTTPS traffic from your own app'](#intercepting-traffic-from-your-own-android-app) or ['intercepting HTTPS traffic from 3rd party apps'](#intercepting-traffic-from-3rd-party-android-apps).

## First time setup

To get started:

1. Start HTTP Toolkit on your computer and click the 'Android device' interception option to expand it:
    ![The Android intercept option, expanded](../../images/android-interceptor.png)
1. Scan the code to start setup.

    If you have a QR code reader:

    1. Scan the code shown and open the link within.
    1. This will take you to Google Play. Install & open the app from there.
    1. HTTP Toolkit will automatically begin interception setup.

    If you don't have a QR code reader:

    1. Install [the HTTP Toolkit app](https://play.google.com/store/apps/details?id=tech.httptoolkit.android.v1) from the play store.
    1. Start the app, press 'Scan Code', and give HTTP Toolkit permission to access your camera.
    1. Scan the code to begin interception setup.
1. Accept each of the shown Android prompts to set up interception:

    You'll be asked to allow HTTP Toolkit to act as a VPN, redirecting your network traffic.

    * Your traffic is never sent to any remote servers, only to your local HTTP Toolkit instance.
    * The VPN is only active when HTTP Toolkit is configured. A notification is always shown whilst the VPN is active.
    * The VPN works by rewriting all outgoing traffic on port 80 & 443, sending it to your local HTTP Toolkit instance instead.

    You'll then be prompted to trust HTTP Toolkit's Certificate Authority (CA) certificate.

    * This is installed as a user-installed CA certificate, and allows secure HTTPS traffic from apps that trust user certificates to be intercepted by HTTP Toolkit.
    * On some devices, this will require you to confirm your device PIN, password or pattern, or to configure one if your device doesn't already have one.
    * The CA used was generated by your computer's HTTP Toolkit instance. It's unique to you, and isn't shared with anybody else or any other devices.
    * If you'd like to remove this CA later, go to Settings -> Security -> Encryption & Credentials -> Trusted Credentials, and remove it from the 'User' tab.
1. You're done. The app should say 'Connected', which means HTTP Toolkit is now be intercepting your device.

In future, just open the HTTP Toolkit app (or any other barcode scanner), scan the code shown on your computer, and interception will start again automatically. You can also press 'Reconnect', to reuse the previous successful configuration, which should work as long as the HTTP Toolkit app is still running on the same port & IP as before.

![The Android app connecting](../../images/android-app.png)

Once this is complete, you're connected! All apps' HTTP traffic will be intercepted and shown on your computer, and HTTPS traffic from apps that trust user-installed CAs will appear too. Hit the "Test Interception" button to open a test page that will confirm that HTTP Toolkit can successfully collect & rewrite traffic from your device.

If you do have running apps that don't trust the CA, you'll see events in HTTP Toolkit like "Certificate rejected for &lt;domain&gt;" and "HTTPS setup failed for &lt;domain&gt;". If you see events like these related to apps you'd like to intercept, you'll need to either configure those apps to trust user-installed CA certificates, or use a rooted device or emulator with ADB-based setup to install a system CA certificate. Each of these cases are covered in more detail below.

## Intercepting browser traffic

All traffic sent by Chrome on Android will trust the HTTP Toolkit certificate automatically. This also applies to webviews inside applications, and to many other browsers including Brave & Microsoft Edge.

Behaviour of non-Chromium browsers varies. In general these should be treated like [intercepting a 3rd party app](#intercepting-traffic-from-3rd-party-android-apps), but many browsers will have their own options available to manually trust HTTPS CA certificates.

## Intercepting traffic from your own Android app

If you are targeting an Android API level below 23 (below Android 7), your application will trust the automatically installed certificate automatically, and no changes are required.

If not, you need to explicitly opt in to trusting the CA certificate. You'll know this is happening because you'll see messages in HTTP Toolkit like "Certificate rejected for connection to..." and "Aborted connection to..." and "HTTPS setup failed for...". Each of these typically means the application rejected our HTTPS interception before sending its requests.

To fix this you need to trust user-installed certificates in your app, like so:

### If you don't have a custom network security config:

1. Put the below into your application's XML resources folder as `network_security_config.xml`:
  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <network-security-config>
      <base-config>
          <trust-anchors>
              <certificates src="system" />
              <certificates src="user" overridePins="true" />
          </trust-anchors>
      </base-config>
  </network-security-config>
  ```
2. Add `android:networkSecurityConfig="@xml/network_security_config"` to the `<application>` element in your application manifest.

That's it!

This configures your application to trust both built-in & user-added CA certificates for all HTTPS connections, for debug & release builds.

You can include this in your config at all times, and it will work with and without HTTP Toolkit. The only risk is that your end users will be able to intercept their own HTTPS traffic from your app, and potentially any users who are tricked into trusting an attacker's CA could have their traffic intercepted. For most applications that isn't a major concern.

If you'd like to enable this only for your debug builds, replace `base-config` with `debug-overrides` in the XML above.

See Android's [network security config documentation](https://developer.android.com/training/articles/security-config) for more details.

### If you already have a custom network security config:

Add `<certificates src="user" overridePins="true" />` within the `<trust-anchors>` element of either your `<base-config>` element (to trust user-added certificates for all builds) or `<debug-overrides>` (to trust user-added certificates in debug builds only).

See Android's [network security config documentation](https://developer.android.com/training/articles/security-config) for more details.

## Intercepting traffic from 3rd party Android apps

To intercept traffic from 3rd party apps or your own existing app builds which don't trust the HTTP Toolkit CA certificate, you need to either do some reverse engineering, or install the app in an emulator or rooted device.

In an emulator/rooted device it's possible to work around default certificate restrictions by editing the system certificates directly, instead of just using user certificates. Doing this will work for the most Android apps, as long as they haven't explicitly locked down the certificates they expect (known as [certificate pinning](https://security.stackexchange.com/questions/29988/what-is-certificate-pinning)).

If that doesn't work or isn't possible, you'll need to edit your target application somehow.

On rooted devices or emulator, the best option to do this is [Frida](https://blog.jamie.holdings/2019/01/19/advanced-certificate-bypassing-in-android-with-frida/). Frida is a framework for dynamic application injection. Once installed, it can rewrite apps on your device on demand to remove most cert pinning restrictions.

If you don't have a rooted device, it's still possible to rewrite the application externally. To do so, you first need to download an APK for the application. [ApkPure.com](https://apkpure.com/) is a useful site to do this for most apps on the Google Play store. You may also be able to retrieve an APK from a device with the application, by using `adb shell pm list packages -f -3` to get the path to installed applications, and `adb pull <apk path>` to pull the APK itself.

Once you have the APK, you'll need to edit the application to trust user certificates and disable any certificate pinning. You can do this using [apk-mitm](https://github.com/shroudedcode/apk-mitm). Apk-mitm automatically opens up the APK, makes the network security config transformations described above, disables most standard certificate pinning, and rebuilds the application ready to be reinstalled.

This isn't foolproof. If it doesn't work, you can run apk-mitm with the `--wait` argument, which allows you to explore the decompiled source of the application, and make your own changes manually before resuming repackaging.